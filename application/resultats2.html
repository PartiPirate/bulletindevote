<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<meta name="description" content="">
	<meta name="author" content="Parti Pirate">

	<title>Mon Bulletin De Vote</title>

	<!-- Facebook -->
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://bulletindevote.partipirate.org/" />
	<meta property="og:title" content="Parti Pirate - Mon Bulletin De Vote" />
	<meta property="og:description" content="Imprimer votre bulletin de vote pour le Parti Pirate" />
	<meta property="og:image" content="https://bulletindevote.partipirate.org/assets/img/logo_voile_fond.png" />
	<meta property="og:locale" content="fr_FR" />
	<meta property="og:locale:alternate" content="en_US" />
	<meta property="fb:page_id" content="partipiratefr" />

	<!-- Google +1 -->
	<meta itemprop="name" content="Parti Pirate - Mon Bulletin De Vote" />
	<meta itemprop="description" content="Imprimer votre bulletin de vote pour le Parti Pirate" />
	<meta itemprop="image" content="https://bulletindevote.partipirate.org/assets/img/logo_voile_fond.png" />
	<meta itemprop="author" content="farlistener" />

	<!-- Twitter -->
	<meta name="twitter:site" content="@partipirate" />
	<meta name="twitter:creator" content="@farlistener" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:url" content="https://bulletindevote.partipirate.org/" />
	<meta name="twitter:title" content="Parti Pirate - Europ&eacute;ennes 2019" />
	<meta name="twitter:description" content="Imprimer votre bulletin de vote pour le Parti Pirate" />
	<meta name="twitter:image" content="https://bulletindevote.partipirate.org/assets/img/logo_voile_fond.png" />
	<meta name="twitter:image:alt" content="Logo du Parti Pirate" />


	<!-- Bootstrap Core CSS -->
	<link href="assets/css/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css">

	<!-- Fonts -->
	<link href="assets/css/plugins/fontawesome/css/all.css" rel="stylesheet" type="text/css">
	<!-- <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'> -->

	<!-- Retina Images Plugin -->
	<script src="assets/js/plugins/retina/retina.min.js"></script>

	<!-- Plugin CSS -->
	<link href="assets/css/plugins/hover/hover.min.css" rel="stylesheet">
	<link href="assets/css/plugins/owl.carousel/owl.carousel.css" rel="stylesheet">
	<link href="assets/css/plugins/owl.carousel/owl.theme.css" rel="stylesheet">
	<link href="assets/css/plugins/owl.carousel/owl.transitions.css" rel="stylesheet">
	<link href="assets/css/plugins/jquery.fs.wallpaper/jquery.fs.wallpaper.css" rel="stylesheet">
	<link href="assets/css/plugins/magnific-popup/magnific-popup.css" rel="stylesheet">

	<!-- Spectrum CSS -->
	<!-- Note: spectrum.css is the default blue theme. To use another theme, uncomment the one you want and delete the rest, including the default spectrum.css! -->
	<link href="assets/css/spectrum.css" rel="stylesheet">
	<link href="assets/css/pp.css" rel="stylesheet">
    <link href="assets/css/donations-gauge.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.js"></script>
      <script src="assets/js/respond.min.js"></script>
    <![endif]-->
</head>
<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(["setDomains", ["*.bulletindevote.partipirate.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.partipirate.org/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 10]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.partipirate.org/piwik.php?idsite=10" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->


    <div id="wrapper">

        <nav class="navbar navbar-dark navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header page-scroll">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
                        <i class="fa fa-bars"></i>
                    </button>
                    <a class="navbar-brand" href="#page-top">
                        <span class="logo">
                            <img src="assets/img/logo.png" alt="">
                        </span>
                    </a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
                    <ul class="nav navbar-nav">
                        <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                        <li class="hidden">
                            <a href="#page-top"></a>
                        </li>
                        <!--<li class="page-scroll">
                            <a href="#team">Notre équipe</a>
                        </li>-->
                        <li class="page-scroll">
                            <a href="#print">Imprimer votre bulletin</a>
                        </li>
                        <li class="page-scroll">
                            <a href="#finance">Financer des bulletins</a>
                        </li>
                        <li class="page-scroll">
                            <a href="https://europeennes.partipirate.org">Les Européennes 2019</a>
                        </li>
                        <li class="page-scroll">
                            <a href="https://europeennes.partipirate.org/kit.html" target="_blank">Le Kit de campagne</a>
                        </li>
                    </ul>
                </div>
                <!-- /.navbar-collapse -->
            </div>
            <!-- /.container -->
        </nav>

		<aside class="bg-parallax-light nopadding" style="background-image: url(assets/img/demo-bgs/fond.png);" data-stellar-background-ratio="0" id="intro">
            <div class="aside-overlay">
                <div class="container">
                    <div class="row text-center">
                        <div class="col-lg-10 col-lg-offset-1 page-scroll"  data-scrollreveal="enter bottom after .6s">
                        </div>
                    </div>
                </div>
            </div>
        </aside>

		        <!-- Services/Features Option 2 -->
        <section id="help" class="services-2">
            <div class="container">
                <div class="row" data-scrollreveal="move 0 over 1s">
                    <div class="col-lg-12 text-center">
                        <h2>Des résultats</h2>
                        <hr class="primary">
						<p>Consulter notre carte de résultats : </p>
						<div align="center" data-scrollreveal="enter bottom move 600px over 2s">
                        	<div id="mapid" style="width: 800px; height: 600px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


	<footer class="footer-1">
            <div class="upper">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <h2 class="script">Parti Pirate</h2>
                            <address>
                                21, place de la République<br>
                                75003 Paris<br>
							</address>
                        </div>
                        <div class="col-md-3">
                            <h4>Liens</h4>
                            <ul class="list-unstyled footer-links">
                                <li>
                                    <a href="https://www.partipirate.org" target="_blank">Site du Parti Pirate</a>
                                </li>
                                <li>
                                    <a href="https://wiki.partipirate.org" target="_blank">Wiki du Parti Pirate</a>
                                </li>
                            </ul>
                        </div>

                        <div class="col-md-3" style="text-align:center;">
                            <h4>Social</h4>
                            <ul class="list-inline">
                                <li>
                                    <a href="https://www.facebook.com/partipiratefr/" target="_blank" class="btn btn-social-light btn-facebook"><i class="fab fa-facebook"></i></a>
                                </li>
                                <li>
                                    <a href="https://twitter.com/partipirate" target="_blank" class="btn btn-social-light btn-twitter"><i class="fab fa-twitter"></i></a>
                                </li>
                                <li>
                                    <a href="https://mastodon.partipirate.org/@PartiPirate" target="_blank" class="btn btn-social-light btn-twitter btn-mastodon" style="text-decoration: none;"><i class="fab fa-mastodon"></i></a>
                                </li>
                                <li>
                                    <a href="https://discord.partipirate.org" target="_blank" class="btn btn-social-light btn-twitter btn-discord" style="text-decoration: none;"><i class="fab fa-discord"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="lower">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <span class="small"><a href="licences.html" title="Information licence">Mentions légales</a></span>
                        </div>
                    </div>
                </div>
            </div>
	</footer>
	</div>

	<div id="volunteerVeil" class="text-center simply-hidden">
		<img src="assets/img/logo_pp.png" alt="Logo du Parti Pirate">
	</div>

	<script src="assets/js/min.js"></script>
	<script src="assets/js/pp.js"></script>
    <script src="assets/js/donations-gauge.js"></script>	

    <!-- Script to Activate Formstone Wallpaper jQuery Plugin - Use this script if you want to use an .mp4, .ovg, or .webm video as a background video. -->
    <script>
    $(".video-bg").wallpaper({
        source: {
            poster: "assets/img/demo-bgs/FondProgramme.jpg"
        }
    });
    </script>
    
<!-- MAP -->    

<!--
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
	integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
	crossorigin="" />
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
	integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
	crossorigin=""></script>
-->	
<link rel="stylesheet" href="leaflet.css"
	integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
	crossorigin="" />
<script src="leaflet.js"
	integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
	crossorigin=""></script>

<style>
	html,
	body {
		height: 100%;
		margin: 0;
	}

	#map {
		width: 800px;
		height: 600px;
	}

	.info {
		padding: 6px 8px;
		font: 14px/16px Arial, Helvetica, sans-serif;
		background: white;
		background: rgba(255, 255, 255, 0.8);
		box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
		border-radius: 5px;
	}

	.info h4 {
		margin: 0 0 5px;
		color: #777;
	}

	.legend {
		text-align: left;
		line-height: 18px;
		color: #555;
	}

	.legend i {
		width: 18px;
		height: 18px;
		float: left;
		margin-right: 8px;
		opacity: 0.7;
	}
</style>
<script type="text/javascript" src="do_getVoteCities.php"></script>
<script>
	/* load Icons */
	var assets = [{name: "printer", file: "assets/printer.svg"}, {name: "candidat", file: "assets/candidat.svg"}];
	assets.forEach(function(data) {
		data.icon = L.icon({
			iconUrl: data.file,
			iconSize: [24, 24]
		});
	});

	var DefaultCoordinates = [46.75, 2.3];
	var DefaultZoom = 6;

	function getCoordinates() {
		var url = new URL(window.location);
		var city = url.searchParams.get("city");
		var rtn = DefaultCoordinates;
		citiesData.features.forEach(
			function (data) {
				if (data.properties.name.toLowerCase() == city) {
					console.log("city " + city + " found in data")
					rtn = data.properties.defaultCoordinates
				} else {
				}
			}
		);
		return rtn;
	}

	function getZoom() {
		var coordinates = getCoordinates();
		if (coordinates[0] != DefaultCoordinates[0]) {
			return 13;
		} else {
			return DefaultZoom;
		}
	}

	var map = L.map('mapid').setView(getCoordinates(), getZoom());

	//L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
	L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox.light'
	}).addTo(map);

	// control that shows state info on hover
	var info = L.control();

	info.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};

	info.update = function (props) {
		this._div.innerHTML = '<h4>Bulletins</h4>' + (props ?
			'<b>' + props.name + '</b><br />' + (props.pourcent == "100%" ? "Machine à voter" : props.pourcent) + '<br />' + (props.cit_votes + " voix") + ' '
			: ' n/d ');
	};

	info.addTo(map);

	// get color depending on population pourcent value
	function getWithColor(d) {
		return d > 4 ? '#10FF10' : // OK
			d > 3 ? '#30FF30' :
				d > 2 ? '#40FF40' :
					d > 1.5 ? '#50FF50' :
						d > 1 ? '#60FF60' :
							d > 0.5 ? '#70FF70' :
								d > 0.3 ? '#80FF80' :
									d > 0.1 ? '#90FF90' :
										d > 0.05 ? '#A0FFA0' :
											d > 0.03 ? '#B0FFB0' :
														'#C0FFC0'; // OK
	}


	// get color depending on population pourcent value
	function getWithoutColor(d) {
		d = ("" + d).replace("%", "") * 1.;

		return d > 4 ? '#4040FF' : // OK
			d > 3 ? '#6060FF' :
				d > 2 ? '#7070FF' :
					d > 1.5 ? '#8080FF' :
						d > 1 ? '#9090FF' :
							d > 0.5 ? '#A0A0FF' :
								d > 0.3 ? '#B0B0FF' :
									d > 0.1 ? '#C0C0FF' :
										d > 0.05 ? '#D0D0FF' :
											d > 0.03 ? '#E0E0FF' :
														'#FFFFFF'; // OK
	}


	function style(feature) {
		return {
			weight: 2,
			opacity: 0.3,
			color: 'black',
			dashArray: '3',
			fillOpacity: 0.8,
			fillColor: feature.properties.cit_ballot_percent == "0" ? getWithoutColor(feature.properties.pourcent) : getWithColor(feature.properties.pourcent)
		};
	}

	function highlightFeature(e) {
		var layer = e.target;

		layer.setStyle({
			weight: 2,
			opacity: 0.8,
			color: '#333',
			dashArray: '',
			fillOpacity: 0.8
		});

		if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
			layer.bringToFront();
		}

		info.update(layer.feature.properties);
	}

	var geojson;

	function resetHighlight(e) {
		geojson.resetStyle(e.target);
		info.update();
	}

	function zoomToFeature(e) {
		map.fitBounds(e.target.getBounds());
	}

	function onEachFeature(feature, layer) {
		layer.on({
			mouseover: highlightFeature,
			mouseout: resetHighlight,
			click: zoomToFeature
		});
	}

	geojson = L.geoJson(citiesData, {
		style: style,
		onEachFeature: onEachFeature
	}).addTo(map);


	/* legend de la carte */

	var legend = L.control({ position: 'bottomleft' });

	legend.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend'),
			grades = [0, 0.03, 0.05, 0.1, 0.3, 0.5, 1, 1.5, 2, 3, 4],
			labels = [],
			from, to;

		for (var i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push('<i style="background:' + getWithColor(from + 0.01) + '"></i> ' + from + "%" + (to ? ' &ndash; ' + to + "%" : ''));
		}

		div.innerHTML = "<div style='text-align: center; font-weight: bolder;'>Avec bulletin</div>" + labels.join('<br>');
		return div;
	};

	legend.addTo(map);

	var legend = L.control({ position: 'bottomright' });

	legend.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend'),
			grades = [0, 0.03, 0.05, 0.1, 0.3, 0.5, 1, 1.5, 2, 3, 4],
			labels = [],
			from, to;

		for (var i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push('<i style="background:' + getWithoutColor(from + 0.01) + '"></i> ' + from + "%" + (to ? ' &ndash; ' + to + "%" : ''));
		}

		div.innerHTML = "<div style='text-align: center; font-weight: bolder;'>Sans bulletin</div>" + labels.join('<br>');
		return div;
	};

	legend.addTo(map);

</script>

<!-- END MAP -->

<!-- BULLETIN -->

<script type="text/javascript" src="do_getRegions.php"></script>
<script type="text/javascript" src="do_getDepartments.php"></script>
<script>
var proportion = 10;
var ratio = 0.75;
/*
var regions = <?=json_encode($allRegions)?>;
var departments = <?=json_encode($allDepartments)?>;
*/

//var regions = [];
//var departments = [];

var numberFormat = new Intl.NumberFormat('fr-FR', {});
var priceFormat = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' });
var actualSearch = null;

function computeTotals() {
	var totalBallots = 0;
	$("#destinations .nb-ballots").each(function() {
		totalBallots += $(this).data("nb-ballots");
	})

	var totalPrice = getPrice(totalBallots);

    $("#total-ballots-span").text(numberFormat.format(totalBallots));
    $("#total-price-span").text(priceFormat.format(totalPrice));
}

function addSearch() {
	if (!actualSearch) return;

	var row = $("<div class='row destination'></div>");

	row.data("type", actualSearch.type);
	row.data("proportion", actualSearch.proportion);
	row.data("insee", actualSearch["insee"]);

	row.append($("<div class='col-xs-3 zone text-left'></div>").text(actualSearch.region ? actualSearch.region : (actualSearch.city ? actualSearch.city : actualSearch.department)));
	row.append($("<div class='col-xs-1 nb-cities text-right'></div>").text(actualSearch.numberOfCities));
	row.append($("<div class='col-xs-1 proportion text-right'></div>").text(actualSearch.proportion + "%"));
	row.append($("<div class='col-xs-3 nb-ballots text-right'></div>").text(numberFormat.format(actualSearch.numberOfBallots)).data("nb-ballots", actualSearch.numberOfBallots));
	row.append($("<div class='col-xs-3 price text-right'></div>").text(priceFormat.format(actualSearch.price)));

	var actionDiv = $("<div class='col-xs-1 action text-right'></div>");

	row.append(actionDiv);

	actionDiv.append($("<button class='btn btn-xs btn-danger btn-remove-destination'><i class='fas fa-times'></i></button>"));

	$("#destinations").append(row);

	row.find(".btn-remove-destination").click(function() {
		$(this).parents(".destination").remove();
		computeTotals();
	});

	computeTotals();
}

function numberOfElectors(numberOfHabitants) {
	return numberOfHabitants * ratio;
}

function getDepartment(name) {
	for(var index = 0; index < departments.length; ++index) {
		if (departments[index].dep_name == name) return departments[index];
	}

	return null;
}

function getRegion(name) {
	for(var index = 0; index < regions.length; ++index) {
		if (regions[index].reg_name == name) return regions[index];
	}

	return null;
}

var requestId = 0;

function getNumberOfBallots(parameters) {
	requestId++;
	parameters.requestId = requestId;

	var responseHandler = function(data) {
		if (data.requestId != requestId) return;

		const numberOfBallots = data.numberOfBallots;
		const price = getPrice(numberOfBallots);

		actualSearch["numberOfCities"] = data.numberOfCities;
		actualSearch["numberOfBallots"] = numberOfBallots;
		actualSearch["price"] = price;

		if (data.numberOfCities == 1) {
			actualSearch["insee"] = data.cities[0].cit_insee;
		}

		if (!$("#selection").html()) {
			var text = "Nombre de villes : " + data.numberOfCities;
			
			if (data.numberOfCities < 20) {
				separator = " (";
				for(var index = 0; index < data.cities.length; ++index) {
					text += separator;
					text += data.cities[index].cit_name;
					
					separator = ", ";
				}
				
				if (data.numberOfCities > 0) {
					text += ")";
				}
			}

			text += "<br>Population : " + numberFormat.format(data.population * 1000) + " habitants<br>Electeurs : ~" + numberFormat.format(data.electors);
			$("#selection").html(text);
		}

		$("#price-span").html(priceFormat.format(price));
		$("#ballots-span").html(numberFormat.format(numberOfBallots));
	};

	actualSearch = parameters;
	$.post("do_getNumberOfBallots.php", parameters, responseHandler, "json");
}

function getPrice(numberOfBallots) {
	if (numberOfBallots == 0) return 0;
	if (numberOfBallots == 100) return 60;
	if (numberOfBallots == 200) return 70;
	if (numberOfBallots <= 500) return 70 + 5 * (numberOfBallots - 200) / 100;
	if (numberOfBallots <= 1000) return 85 + 3 * (numberOfBallots - 500) / 100;
	if (numberOfBallots <= 10000) return 100 + 2.22 * (numberOfBallots - 1000) / 100;

	return (numberOfBallots) * 0.0183;
}

$(function() {

	$("#add-destination-button").click(function(event) {
		event.stopImmediatePropagation();
		event.preventDefault();
		addSearch();
	});

	$("#region-select").change(function() {
		var region = getRegion($(this).val());

		if (region) {
			$("#selection").html("Region : " + region.reg_name + "<br>Nombre de villes : " + region.reg_number_of_cities + "<br>Population : " + numberFormat.format(region.reg_population * 1000) + " habitants<br>Electeurs : ~" + numberFormat.format(numberOfElectors(region.reg_population * 1000)));

			getNumberOfBallots({"region" : region.reg_name, "proportion": proportion, type: "region"});
		}
		else {
			$("#selection").html("");
			actualSearch = null;
		}
	});

	$("#departement-select").change(function() {
		var department = getDepartment($(this).val());
		$("#city-autocomplete").val("");

		if (department) {
			$("#selection").html("Departement : " + department.dep_name + "<br>Nombre de villes : " + department.dep_number_of_cities + "<br>Population : " + numberFormat.format(department.dep_population * 1000) + " habitants<br>Electeurs : ~" + numberFormat.format(numberOfElectors(department.dep_population * 1000)));

			getNumberOfBallots({"department" : department.dep_name, "proportion": proportion, type: "departement"});
		}
		else {
			$("#selection").html("");
			actualSearch = null;
		}
	});

	$("#city-autocomplete").keyup(function() {
		var department = getDepartment($("#departement-select").val());
		var city = $(this).val();

		if (city) {
//			$("#selection").html("Departement : " + department.dep_name + "<br>Nombre de villes : " + department.dep_number_of_cities + "<br>Population : " + numberFormat.format(department.dep_population * 1000) + " habitants<br>Electeurs : ~" + numberFormat.format(numberOfElectors(department.dep_population * 1000)));

			$("#selection").html("");
			
			var parameters = {"city" : city, "proportion": proportion, type: "villes"};
			if (department) {
				parameters["department"] = department.dep_name;
			}
			
			getNumberOfBallots(parameters);
		}
		else {
			$("#selection").html("");
			actualSearch = null;
		}
	});

	$("#proportion").change(function() {
		proportion = $(this).val();

		switch($("#zoneInput").val()) {
			case "villes": 
				$("#city-autocomplete").keyup();
				break;
			case "departement": 
				$("#departement-select").change();
				break;
			case "region": 
				$("#region-select").change();
				break;
		}

	});
});

</script>

<!-- END BULLETIN -->

</body>

</html>
